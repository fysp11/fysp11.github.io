---
import { getCollection, type CollectionEntry } from 'astro:content';
import FloatingContainer from './FloatingContainer.astro';
import Menu from './Menu.tsx';

const allProjects = await getCollection('projects');
const activeProjects = allProjects.filter((p: CollectionEntry<'projects'>) => p.data.active);

const projectLinks = activeProjects.map((p: CollectionEntry<'projects'>) => ({
  label: p.data.menuLabel,
  href: `/projects/${p.data.slug}`
}));

const menuSections = [
  {
    label: 'fysp.dev',
    href: '#',
    children: [
      { label: 'Home', href: '/' },
      { label: 'About', href: '/#bio' },
      { label: 'Experience', href: '/#experience' },
      { label: 'Social', href: '/#social' }
    ]
  },
  {
    label: 'Projects',
    href: '/projects',
    children: [{ label: 'all', href: '/projects' }, ...projectLinks]
  }
];
---

<FloatingContainer>
  <Menu sections={menuSections} client:load />
</FloatingContainer>
