---
import Layout from '@/layouts/Layout.astro';
import Pill from '@/components/ui/Pill.astro';
import profile from '@/content/profile.json';
import { Image } from 'astro:assets';
// import { ArrowUpRight } from 'lucide-react';

const { frontmatter } = Astro.props;

const { title, description, pubDate, heroImage, tags } = frontmatter;

const formattedDate = new Date(pubDate).toLocaleDateString('en-US', {
  year: 'numeric',
  month: 'long',
  day: 'numeric',
});
---

<Layout title={title} description={description} image={heroImage}>
  <Fragment slot="head">
    {/* eslint-disable-next-line astro/no-set-html-directive */}
    <script type="application/ld+json" set:html={JSON.stringify([{
      "@context": "https://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement": [
        {
          "@type": "ListItem",
          "position": 1,
          "name": "Home",
          "item": Astro.site
        },
        {
          "@type": "ListItem",
          "position": 2,
          "name": "Projects",
          "item": `${Astro.site}projects`
        },
        {
          "@type": "ListItem",
          "position": 3,
          "name": title
        }
      ]
    }, {
      "@context": "https://schema.org",
      "@type": "Article",
      "headline": title,
      "description": description,
      "image": heroImage,
      "datePublished": pubDate,
      "author": {
        "@type": "Person",
        "name": profile.personal.name,
        "url": Astro.site
      }
    }])} />
  </Fragment>
  <article class="flex flex-col gap-8">
    <header class="flex flex-col gap-4">
      <h1 class="text-4xl font-bold leading-tight tracking-tighter">{title}</h1>
      <p class="text-lg text-muted-foreground">{description}</p>
      <time class="text-sm text-muted-foreground">{formattedDate}</time>

      {heroImage && (
        <Image
          src={heroImage}
          alt={description}
          width={1200}
          height={630}
          format="webp"
          loading="eager"
          fetchpriority="high"
          class="mt-4 aspect-video w-full rounded-lg border border-border object-cover"
        />
      )}

      <!-- <div class="mt-4 flex flex-wrap items-center gap-4">
        {repoUrl && (
          <a href={repoUrl} target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-2 rounded-full bg-secondary px-4 py-2 text-sm font-medium text-secondary-foreground transition-colors hover:bg-secondary/80">
            View Repository <ArrowUpRight className="h-4 w-4" />
          </a>
        )}
        {liveUrl && (
          <a href={liveUrl} target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-2 rounded-full bg-primary px-4 py-2 text-sm font-medium text-primary-foreground transition-colors hover:bg-primary/80">
            Live Demo <ArrowUpRight className="h-4 w-4" />
          </a>
        )}
      </div> -->

      {tags && tags.length > 0 && (
        <div class="mt-4 flex flex-wrap gap-2">
          {tags.map((tag: string) => <Pill>{tag}</Pill>)}
        </div>
      )}
    </header>

    <div class="prose prose-invert max-w-4xl space-y-4">
      <slot />
    </div>
  </article>
</Layout>
